input int A[_];
int n = A.size;

int ln = 0;
for (; 2 ^ ln < n; ln++);

int B[ln + 1, n];
output int S[n];

pardo(i : n) B[0, i] = A[i];

for (int t = 0; 2 ^ t < n; t++)
    pardo(i : n / 2 ^ (t + 1))
        B[t + 1, i] = B[t, 2 * i] + B[t, 2 * i + 1];

for (int t = 0; 2 ^ t < n; t++)
    pardo(i : n / 2 ^ (ln - t)) {
        B[ln - t - 1, 2 * i] = B[ln - t, i] - B[ln - t - 1, 2 * i + 1];
        B[ln - t - 1, 2 * i + 1] = B[ln - t, i];
    }

pardo(i : n) S[i] = B[0, i];


